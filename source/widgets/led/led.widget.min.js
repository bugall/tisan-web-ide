/*! iot-board 2015-09-13 */
!function(){return window.iotboard?(window.iotboard.defineWidget("led",{status:{red:255,green:255,blue:255,freq:100,white:100},render:function(a){var a=clone(a);return a.status=this.status,template("template-led",a)},listeners:[{selector:".btn-refresh",event:"click",behavior:"get"},{selector:".btn-set",event:"click",behavior:"set"}],parseStatus:function(a){return{red:parseInt(a.find(".rVal").val()),green:parseInt(a.find(".gVal").val()),blue:parseInt(a.find(".bVal").val()),freq:parseInt(a.find(".freqVal").text()),white:parseInt(a.find(".wVal").text())}},onRendered:function(a){console.log("on widget rendered."),a.find(".picker").each(function(){var a=this.getContext("2d"),b=new Image;b.onload=function(){console.log("color picker loaded..."),a.drawImage(b,0,0)};var c="/iotboard/dist/widgets/led/colorwheel.png";b.src=c}),a.find(".picker").on("click",function(a){var b=$(this).closest(".widget"),c=this.getContext("2d"),d=$(this).offset(),e=Math.floor(a.pageX-d.left),f=Math.floor(a.pageY-d.top),g=c.getImageData(e,f,1,1),h=g.data;b.find(".rPrev").css("background-color","#"+h[0].toString(16)+"0000"),b.find(".gPrev").css("background-color","#00"+h[1].toString(16)+"00"),b.find(".bPrev").css("background-color","#0000"+h[2].toString(16)),b.find(".rVal").val(h[0]),b.find(".gVal").val(h[1]),b.find(".bVal").val(h[2])}),a.find(".freqCtrl").change(function(){$(this).closest(".controls").find(".freqVal").text($(this).val())}),a.find(".wCtrl").change(function(){$(this).closest(".controls").find(".wVal").text($(this).val())})}}),void console.log("add widget {led}")):void console.log("iotboard not initialized!")}();
